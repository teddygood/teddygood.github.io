---
title: "Fastbook Questionnaire 01 Solution"
date: '2021-10-26'
draft: true

description: fastai와 파이토치가 만나 꽃피운 딥러닝 질문지 정리
---

## Chapter 1. 딥러닝으로 떠나는 여행

### 1. 딥러닝에 다음과 같은 사항이 필요한가요?

- 뛰어난 수학 지식 (거짓)  
정답은 `고등학교 수준 수학으로 충분하다.`이지만, 솔직히 깊이 들어가면 들어갈수록 수학에 대한 지식들이 많으면 공부하는데 더 편하다. 
- 많은 양의 데이터 (거짓)  
50개 미만의 데이터로도 의미 있는 결과를 만들 수 있다.
- 고가의 컴퓨터 (거짓)  
클라우드 서비스를 이용하면 최소한의 비용으로 고효율의 그래픽카드를 사용할 수 있다.
- 박사 학위 (거짓)  
공부만 하면 누구든지 신경망을 만들어보고 사용해볼 수 있다.

### 2. 현재 딥러닝이 세계 최고의 도구로 자리매김한 다섯 가지 영역은 무엇인가요?

- 자연어 처리(NLP)  
- 영상 처리(Computer Vision)
- 의학
- 생물학
- 이미지 생성
- 추천 시스템
- 게임 플레이
- 로봇공학
- 기타 활용 분야 
  
### 3. 인공 뉴런의 원리에 기반한 첫 번째 장치의 이름은 무엇인가요?

Mark 1 Perceptron(built by Frank Rosenblatt)

### 4. 병렬 분산 처리(PDP)에 대한 요구 사항은 무엇인가요?

Parallel Distributed Processing

- 처리 유닛 집합
- 활성 상태
- 각 유닛의 출력 함수
- 유닛 간의 연결 패턴
- 연결망으로 활동 패턴을 전파하는 전파 규칙
- 유닛의 현재 상태에 영향을 주는 입력을 결합하여 유닛의 출력을 생성하는 활성화 규칙
- 경험에 따라 연결 패턴을 바꾸는 학습 규칙
- 시스템이 작동하는 환경

### 5. 신경망 분야의 발전을 저해하는 두 가지 이론적 오해는 무엇인가요?

1969년 Marvin Minsky, Seymour Papert는 **Perceptrons(MIT Press)**에서 인공 뉴런의 단일 계층은 XOR 논리 게이트 같이 간단하지만 수학적으로 중요한 개념을 학습할 수 없다는 사실과 여러 계층을 사용하면 이 문제를 해결할 수 있다는 것까지 증명했다. 그러나 첫 번째 통찰만이 알려져서 그 후 20년동안 신경망을 포기했다.

1980년의 모델은 두 개의 레이어를 가진 뉴런으로 구축했다. 단일 뉴런 계층을 추가한 신경망은 모든 수학적 함수를 근사할 수 있지만, 유용하게 사용하기 위해서는 너무 많은 뉴런이 필요하여 신경망이 커지고 매우 느려질 수 있다. 레이어를 추가하면 성능이 향상된다는 것이 증명되었지만, 이 통찰도 인정되지 않았다. 후에 데이터 가용성이 증가하고 하드웨어 성능이 개선된 현재에는 신경망을 잘 사용하고 있다.

### 6. GPU란 무엇인가요?

그래픽 처리 장치(Graphics Prcessing Unit)  
수천개의 단일 작업을 동시에 처리할 수 있는 병렬 처리 방식을 가진 프로세서이다. 3D 환경의 그래픽을 출력하는데 주로 쓰이며, GPGPU(General-Purpose computing on Graphics Processing Units)로 CPU가 맡았던 연산에 사용하기도 한다. 

주요 딥러닝 라이브러리는 AMD GPU를 지원하지 않는 것으로 알고 있으며, 대부분의 딥러닝 라이브러리가 CUDA로 되어 있기 때문에 NVIDIA의 GPU를 사용해야 한다.

### 7. 노트북을 열고 1+1 코드를 담은 셀을 실행해보세요. 어떤 일이 일어나나요?

여기서 노트북은 Jupyter Notebook을 의미한다. 직접 실행해보자.

### 8. 이 장에 해당하는 출력이 제거된 버전의 노트북을 살펴보고, 각 셀을 실행하기 전에 일어날 일을 추측해보세요.

[course.fast.ai](https://course.fast.ai/start_colab)에서 받거나 [fastbook repo](https://github.com/fastai/fastbook)에서 받고 Colab 등으로 직접 실습해보자.

### 9. 주피터 노트북의 사용법을 다룬 온라인 부록을 읽어보세요.

다운 받은 폴더에서 `app_jupyter.ipynb`를 실행해서 읽어보자.

### 10. 전통적인 컴퓨터 프로그램으로 이미지를 인식하는 작업이 어려운 이유는 무엇인가요?

PDP 책에서는 두뇌가 일반적인 컴퓨터 프로그램과 매우 다른 방식으로 작동하므로 두뇌가 매우 쉽게 할 수 있는 일(e.g. 이미지 인식)을 컴퓨터 프로그램이 잘 처리하지 못한다고 전제했다.

쉽게 생각하면 우리는 고양이든 개든 그냥 보면 쉽게 인식하지만 컴퓨터는 한 번에 알아보는 것을 못한다. 정확한 알고리즘으로 인식하는 과정들을 거쳐야하기 때문에 어렵다.

### 11. Arthur Samuel이 '가중치 할당'으로 의미한 바는 무엇인가요?

가중치는 일반적으로 모델의 parameter라고 부르며, '가중치 할당'이란 프로그램이 작동할 방식을 정의하는 것을 의미한다. 모델은 가중치 값을 조정하여 즉, 가중치 값을 할당하여 다양한 결과를 얻어낼 수 있다. 또한, '성능을 최대화하는 방향으로 할당된 가중치를 수정해나가는 메커니즘'을 자동화하여 컴퓨터가 경험으로부터 학습하며 프로그래밍할 수 있다.

### 12. 사무엘이 말한 '가중치'에 대응하는 일반적인 딥러닝 용어는 무엇인가요?

가중치에 대응하는 용어는 parameter이다. paprameter는 데이터를 통해 구해지며 모델 내부적에서 자동으로 결정되는 값이다. hyperparameter와 다르게 사용자에 의해 조정되지 않는다. 

### 13. 머신러닝 모델에 대한 사무엘의 견해를 그림 한 장으로 요약해보세요.

p.55를 참고하자.

### 14. 딥러닝 모델이 내놓은 특정 예측 결과의 이유를 이해하기는 왜 어려운가요?

딥러닝 모델은 수천까지는 아니더라도 최소 수백 개의 레이어를 갖고 있을 것이며, 레이어의 개수 이상의 파라미터들이 상호작용을 하고 있을 것이다. 그렇기에 딥러닝 모델이 내놓은 결과에 대해 특정한 이유를 찾는 것은 어렵다. 이러한 딥러닝의 복잡한 특성 때문에 신경망이 '왜 이런 예측을 하는지' 이해하는 것은 매우 어렵다.

### 15. 신경망이 모든 수준의 정확도로 모든 수학적 문제를 해결할 수 있음을 보여주는 정리의 이름은 무엇인가요?

일반 근사 정리(universal approximation theorem)  
쉽게 설명하면 1개의 hidden layer를 가진 Neural Network를 이용하여 어떠한 함수든 근사시킬 수 있는 이론이다.

### 16. 모델을 학습시키려면 무엇이 필요한가요?

어떠한 문제에 대한 architecture부터 선택한 후, dataset을 선택한다. 또한, 데이터에서 잘 작동하도록 특정 파라미터의 값을 찾아야 한다. 또한, 모델이 예측을 얼마나 잘 수행했는지 측정하기 위해서 손실 함수를 정의해야 한다.

모델을 학습시킬 때는 모델이 일반화되도록 해야 한다. 데이터에서 일반적인 내용을 학습하면 새로운 데이터에 적용하여 좋은 예측을 만들어낼 수 있다.

### 17. 피드백 루프는 예측 치안 유지 모델에 어떤 영향을 미치나요?

긍정 피드백 루프(positive feedback loop)  
모델을 많이 사용할수록 데이터의 편향이 커지고, 모델 자체의 편향도 더 커지는 결과가 지속해서 발생한다.

예측 치안 유지(predictive policing) 모델은 과거에 체포가 발생한 장소에 기반하여 만들어진다. 범죄가 아닌 체포를 예측하는 모델이기에 기존 치안 활동의 편향을 부분적으로 반영한다. 법 집행관이 해당 모델을 활용해 치안 활동을 집중해야 할 위치를 결정하면, 그 장소에서 체포되는 건수가 증가하는 결과를 만들 수 있다. 이후 이 체포 데이터는 미래의 모델을 다시 학습할 수 있는 입력으로 활용된다.

### 18. 고양이 인식 모델에는 항상 224 X 224 픽셀 크기의 이미지를 사용해야만 하나요?

꼭 그런 건 아니다. 224 픽셀은 영상 처리 분야의 역사적인 이유이며, 흔하게 찾아볼 수 있는 표준적인 크기이다. 다른 크기를 사용할 수도 있다. 그러나 height X width 모두 홀수를 사용하는 것을 추천한다.  

### 19. 분류와 회귀는 어떻게 다른가요?

분류(classification)와 회귀(regression)는 지도 학습(supervised learning)의 하위 카테고리라는 공통점이 있지만, classification은 과거의 관측을 기반으로 새로운 샘플의 범주형 클래스 레이블을 예측하는 것이 목적이고 regression은 연속적인 출력 값을 예측하는 것이 목적이다. 

### 20. 검증용 데이터셋과 테스트용 데이터셋이란 무엇인가요? 왜 필요한가요?

검증용 데이터셋(validation set)은 모델의 정확도를 측정하는 데 사용하며, 보통 임의로 선택해서 구성한다. 또한, 검증용 데이터셋은 과적합을 방지하기 위해 모델을 평가하는 데 사용하는 데이터셋이다.

하이퍼파라미터를 적용한 모델들은 검증용 데이터셋을 본 사람에게 간접적인 영향을 받게 된다. 사람으로 인해 모델이 검증용 데이터셋에 과적합될 수 있기 때문에 다른 보관용 데이터를 구축하는데 그것이 테스트용 데이터셋(test set)이다. 테스트용 데이터셋은 모델을 개선하는 데 사용하지 않고 마지막에 최종 모델을 평가하는 목적으로만 활용한다.

### 21. 검증용 데이터셋을 명시적으로 제공하지 않을 때 fastai는 어떤 조치를 취하나요?

fastai는 기본적으로 검증용 데이터셋을 명시적으로 제공하지 않았을 때 데이터의 20%를 자동으로 검증용 데이터셋으로 구성한다.

### 22. 항상 임의로 추출한 표본만으로도 검증용 데이터셋을 구축할 수 있나요? 그렇다면, 또는 그렇지 않다면 그 이유는 무엇인가요?

검증용 데이터셋은 미래의 새로운 데이터를 대표해야 하기 때문에 항상은 아니다. 시계열에서 랜덤하게 선택된 데이터는 예측하려는 날짜의 전과 후의 데이터를 모두 포함하기 때문에 문제를 지나치게 쉽게 만든다. 그러므로 데이터에 날짜가 포함되고 해당 데이터로 미래에 사용할 모델을 구축하려면 최근 날짜들로 검증용 데이터셋을 구성하면 좋다.

### 23. 과적합이란 무엇인가요? 예를 들어 설명해보세요.

학습이 나쁜 방향으로 이루어지면 학습의 시간이 길어질수록 학습용 데이터셋에서의 정확도는 증가하지만, 검증용 데이터셋에서의 정확도는 한동안 개선되다가 점점 악화된다. 모델이 학습용 데이터를 통째로 외워버리는 현상이 발생하며, 새로운 데이터에 대해 예측을 잘못 수행할 수 있다. 이를 과적합(overfit)되었다고 한다.

### 24. 평가지표란 무엇인가요? 손실과는 어떻게 다른가요?

평가지표(metric)란 검증용 데이터셋을 사용하여 모델이 내놓은 예측의 품질을 측정하는 함수이다. 사람이 활용하고 이해할 수 있는 형태로 정의되어 있다.

손실(loss)은 학습 시스템이 가중치를 자동으로 갱신하는 데 사용할 수 있는 성능 측정을 정의하는 것이다. 모델을 훈련시킬 때 손실 함수로 최소로 만들어주는 가중치들을 찾는 것을 목표로 한다. 

### 25. 사전 학습된 모델은 어떤 면에서 도움이 되나요?

사전 학습된 모델은 다른 데이터셋에서 이미 학습된 가중치를 갖고 있기 때문에 학습용 데이터가 전혀 준비되지 않은 상황에서 매우 유용하다. pretrained model은 데이터, 시간, 비용을 적게 들이면서 빠르고 저오학한 모델을 학습시키는 중요한 기법이다.

### 26. 모델의 '머리'란 무엇인가요?

모델의 마지막 부분을 head라고 한다. 마지막 부분은 마지막 계층을 의미하는데 마지막 계층은 보통 원래 학습된 작업에 특별히 맞도록 정의한 부분이다.

### 27. CNN의 초기 계층은 어떤 종류의 특징을 찾아내나요? 후기 계층은 어떤가요?

CNN의 초기 계층은 대각선, 수평선, 수직선, 다양한 그라데이션부터 시작해서 후기 계층으로 갈수록 간단한 패턴, 고차원적인 형태의 특징을 찾아낸다.

### 28. 이미지 모델은 사진에만 유용한가요?

다양한 방법으로 이미지 데이터가 아닌 데이터들도 이미지로 변환될 수 있기 때문에 꼭 사진에만 유용한 것이 아니다. 

### 29. architecture이란 무엇인가요?

특정 유형의 모델이 내부적으로 작동하는 방식에 관한 일반적인 템플릿이다. 예를 들어 입력 데이터와 파라미터를 전달받는 실제 수학 함수 등이 있다.

### 30. segmentation이란 무엇인가요?

segmentation은 이미지의 모든 개별 픽셀을 인식하는 모델을 만드는 일이다. 

### 31. y_range 인자는 언제, 왜 쓰이나요?

y_range는 fastai의 라이브러리의 다양한 함수에 매개변수로 전달되어 함수가 범주형 값 대신 연속적인 숫자 값을 예측할 때 예측 대상의 범위를 지정하는 용도로 사용한다.

### 32. hyperparameter란 무엇인가요?

모델링할 때 사용자가 직접 세팅해주는 값이다. 다양한 하이퍼파라미터가 존재하며 최적의 모델 생성을 위해 조정한다. 많은 사람들이 파라미터와 하이퍼파라미터를 구분 없이 사용하는 경우가 많다. 

### 33. 조직에서 AI를 사용할 때 실패를 방지하는 가장 좋은 방법은 무엇인가요?

테스트용 데이터셋과 검증용 데이터셋이 무엇이고 왜 중요한지 잘 이해한다면 조직에서 AI를 사용할 때 가장 큰 실패를 방지할 수 있다. 외부 업체나 서비스 사용을 고려한다면 외부 업체가 볼 수 없는 test set을 따로 분리해둬야 한다. 비즈니스에서 중요하다고 판단되는 평가지표를 설정하고 평가지표와 test set으로 직접 평가 후 어느 정도의 성능, 기술, 서비스 등이 필요한지를 직접 결정할 수 있다. 