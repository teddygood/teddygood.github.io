<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Group-Study/data-engineering/data-engineer-with-python-week-02">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Data Engineering ìŠ¤í„°ë”” 2ì£¼ì°¨ @ Chanho Lee</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://teddygood.github.io/docs/Group-Study/data-engineering/data-engineer-with-python-week-02"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Engineering ìŠ¤í„°ë”” 2ì£¼ì°¨ @ Chanho Lee"><meta data-rh="true" name="description" content="PseudoLab Data Science Fellowship 1ê¸°"><meta data-rh="true" property="og:description" content="PseudoLab Data Science Fellowship 1ê¸°"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://teddygood.github.io/docs/Group-Study/data-engineering/data-engineer-with-python-week-02"><link data-rh="true" rel="alternate" href="https://teddygood.github.io/docs/Group-Study/data-engineering/data-engineer-with-python-week-02" hreflang="ko"><link data-rh="true" rel="alternate" href="https://teddygood.github.io/docs/Group-Study/data-engineering/data-engineer-with-python-week-02" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3GO7VFCZS7-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Chanho Lee RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Chanho Lee Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EFT0SBFJCH"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-EFT0SBFJCH",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Chanho Lee" href="/opensearch.xml">
<link rel="stylesheet" href="/katex/katex.min.css"><link rel="stylesheet" href="/assets/css/styles.236ff803.css">
<link rel="preload" href="/assets/js/runtime~main.d2d4c5dd.js" as="script">
<link rel="preload" href="/assets/js/main.c6c575b9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.jpg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Chanho Lee</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Wiki</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/blog/archive">Archive</a><a class="navbar__item navbar__link" href="/blog/tags">Tags</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/teddygood" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://www.linkedin.com/in/teddygood/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="LinkedIn Account"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ì–´ë‘ìš´ ëª¨ë“œì™€ ë°ì€ ëª¨ë“œ ì „í™˜í•˜ê¸° (í˜„ì¬ ë°ì€ ëª¨ë“œ)" aria-label="ì–´ë‘ìš´ ëª¨ë“œì™€ ë°ì€ ëª¨ë“œ ì „í™˜í•˜ê¸° (í˜„ì¬ ë°ì€ ëª¨ë“œ)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="ê²€ìƒ‰"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">ê²€ìƒ‰</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤í•˜ê¸°" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Dev-Tips">Dev Tips</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Dev Tips&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/introduction">ğŸ‘‹ğŸ»</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/Group-Study">Group Study</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Group Study&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Group-Study/data-engineering">Data Engineering</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Data Engineering&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-01">Data Engineering ìŠ¤í„°ë”” 1ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-02">Data Engineering ìŠ¤í„°ë”” 2ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-03">Data Engineering ìŠ¤í„°ë”” 3ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-04">Data Engineering ìŠ¤í„°ë”” 4ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-06">Data Engineering ìŠ¤í„°ë”” 6ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-07">Data Engineering ìŠ¤í„°ë”” 7ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-08">Data Engineering ìŠ¤í„°ë”” 8ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-10">Data Engineering ìŠ¤í„°ë”” 10ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-12">Data Engineering ìŠ¤í„°ë”” 12ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-13">Data Engineering ìŠ¤í„°ë”” 13ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-15">Data Engineering ìŠ¤í„°ë”” 15ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-16">Data Engineering ìŠ¤í„°ë”” 16ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-20">Data Engineering ìŠ¤í„°ë”” 20ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-22">Data Engineering ìŠ¤í„°ë”” 22ì£¼ì°¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-24">Data Engineering ìŠ¤í„°ë”” 24ì£¼ì°¨</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/Group-Study/deep-learning">Deep Lenarning</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Deep Lenarning&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/Group-Study/java">Java</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Java&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Personal-Study">Personal Study</a><button aria-label="ì ‘ì„ ìˆ˜ ìˆëŠ” ì‚¬ì´ë“œë°” ë¶„ë¥˜ &#x27;Personal Study&#x27; ì ‘ê¸°(í¼ì¹˜ê¸°)" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="ì‚¬ì´ë“œë°” ìˆ¨ê¸°ê¸°" aria-label="ì‚¬ì´ë“œë°” ìˆ¨ê¸°ê¸°" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="í™ˆ" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Group-Study"><span itemprop="name">Group Study</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/Group-Study/data-engineering"><span itemprop="name">Data Engineering</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data Engineering ìŠ¤í„°ë”” 2ì£¼ì°¨</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">ì´ í˜ì´ì§€ì—ì„œ</button></div><div class="theme-doc-markdown markdown"><h1>Inrtroduction to Data Engineering</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-data-engineering">Introduction to Data Engineering<a href="#introduction-to-data-engineering" class="hash-link" aria-label="Introduction to Data Engineeringì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="Introduction to Data Engineeringì— ëŒ€í•œ ì§ì ‘ ë§í¬">â€‹</a></h2><p>ìµœì•…ì˜ ìƒí™©</p><ul><li>ë°ì´í„°ëŠ” í©ì–´ì ¸ìˆìŒ</li><li>ë¶„ì„ì— ìµœì í™”ë˜ì–´ ìˆì§€ ì•ŠìŒ</li><li>ë ˆê±°ì‹œì½”ë“œ ë•Œë¬¸ì— ë°ì´í„°ê°€ ì†ìƒë˜ì–´ ìˆìŒ</li></ul><p>data engineerëŠ” data scientist ì‚¶ì„ í¸í•˜ê²Œ í•¨</p><ul><li>ì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ extractí•˜ê³  single DBì— load</li><li>ë¶„ì„ì„ ìœ„í•˜ì—¬ DBë¥¼ ìµœì í™”í•˜ì—¬ ì¿¼ë¦¬ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ ë§Œë“¬</li><li>ì†ìƒëœ ë°ì´í„°ë„ ì œê±°</li><li>í™•ì¥ì„ ì›í•˜ëŠ” ë°ì´í„° ì¤‘ì‹¬(data-driven) íšŒì‚¬ì—ì„œ ê°€ì¥ ê°€ì¹˜ìˆëŠ” ì‚¬ëŒ</li></ul><p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ ì •ì˜</p><ul><li>DBì™€ large-scale processing system ê°™ì€ architectureë¥¼ ê°œë°œ, êµ¬ì„±, í…ŒìŠ¤íŠ¸, ìœ ì§€ ê´€ë¦¬í•˜ëŠ” ì—”ì§€ë‹ˆì–´</li><li>ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬</li><li>ì»´í“¨íŒ…ì„ ìˆ˜í–‰í•˜ëŠ” machine clusterë¥¼ ì‚¬ìš© ë° ì„¤ì • -&gt; virtual machineì˜ cluster<ul><li>cluster: ê³ ì„±ëŠ¥ ì»´í“¨íŒ…ì„ ìœ„í•´ ì—¬ëŸ¬ ë‹¨ë§ì˜ ì»´í“¨í„°ë¡œ êµ¬ì„±ëœ ì»´í“¨í„° ì§‘í•©</li></ul></li></ul><p>Data Engineer vs Data Scientist</p><ul><li>Data Engineer<ul><li>í™•ì¥ê°€ëŠ¥í•œ ë°ì´í„° ì•„í‚¤í…ì²˜ ê°œë°œ</li><li>ë°ì´í„° ìˆ˜ì§‘ ê°„ì†Œí™”</li><li>ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í”„ë¡œì„¸ìŠ¤ ì„¤ì •</li><li>ì†ìƒëœ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ì—¬ ë°ì´í„° ë³´í˜¸</li><li>í´ë¼ìš°ë“œ ê¸°ìˆ ì— ì˜ ì•Œì•„ì•¼ í•¨</li></ul></li><li>Data Scientist<ul><li>ë°ì´í„° íŒ¨í„´ì„ ì°¾ê¸° ìœ„í•´ í•˜ëŠ” ë°ì´í„° ë§ˆì´ë‹</li><li>ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì— í†µê³„ ëª¨ë¸ ì ìš©</li><li>ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ ì˜ˆì¸¡ ëª¨ë¸ êµ¬ì¶•</li><li>ë¹„ì¦ˆë‹ˆìŠ¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ë„êµ¬ ê°œë°œ</li><li>cleaning ì‘ì—…ìœ¼ë¡œ ì´ìƒì¹˜(outlier) ì œê±°</li><li>ë¹„ì¦ˆë‹ˆìŠ¤ì— ëŒ€í•œ ê¹Šì€ ì´í•´ë¥¼ ê°€ì§</li></ul></li></ul><p>Database</p><ul><li>ê°„ëµí•˜ê²Œ ë§í•˜ë©´ DBëŠ” ë§ì€ ì–‘ì˜ ë°ì´í„°ë¥¼ ë³´ìœ í•˜ëŠ” ì»´í“¨í„° ì‹œìŠ¤í…œ</li><li>ì• í”Œë¦¬ì¼€ì´ì…˜ì€ íŠ¹ì • ê¸°ëŠ¥ì„ ì œê³µí•˜ê¸° ìœ„í—¤ DBì— ì˜ì¡´</li></ul><p>Processing</p><ul><li>clean, aggregate, joiní•˜ê¸° ìœ„í•´ ë°ì´í„° ì²˜ë¦¬</li><li>ì—„ì²­ë‚œ ì–‘ì˜ ë°ì´í„° ì²˜ë¦¬<ul><li>ë³‘ë ¬ ì²˜ë¦¬</li><li>í•œ ì»´í“¨í„°ì—ì„œ ë°ì´í„° ì²˜ë¦¬ -&gt; virtual machine clusterë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ì‚°í•˜ì—¬ ë°ì´í„° ì²˜ë¦¬<ul><li>ì´ëŸ° íˆ´ì€ ê¸°ë³¸ ì•„í‚¤í…ì²˜ ì¶”ìƒí™”, ê°„ë‹¨í•œ API ì œê³µ</li><li>e.g.<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">df </span><span class="token operator">=</span><span class="token plain"> spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parquet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;users.parquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">outliers </span><span class="token operator">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">filter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;age&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">outliers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul></li></ul><p>Scheduling</p><ul><li>ë°ì´í„°ê°€ íŠ¹ì • ê°„ê²©ì— ë”°ë¼ ì ì ˆí•œ ì‹œê°„ì— í•œ ì¥ì†Œì—ì„œ ë‹¤ë¥¸ ì¥ì†Œë¡œ ì´ë™í•˜ëŠ”ì§€ í™•ì¸</li><li>ê²½ìš°ì— ë”°ë¼ ì²˜ë¦¬ ì‘ì—…ì´ ì˜¬ë°”ë¥´ê²Œ ì‘ë™í•˜ë ¤ë©´ íŠ¹ì • ìˆœì„œë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•¨<ul><li>ì‹œê°„ì— ë§ê²Œ ì‹¤í–‰ë˜ë„ë¡ í•˜ê³  ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ì‹¤í–‰ë˜ë„ë¡ ë§Œë“¬</li></ul></li><li>ì‘ì—…ì˜ ì¢…ì†ì„±ì´ ì˜¬ë°”ë¥´ê²Œ í•´ê²°ë˜ì–´ì•¼ í•¨</li></ul><p>Existing tools</p><ul><li>Databases: MySQL, PostgreSQL</li><li>Processing: Apache Spark, Apache Hive</li><li>Scheduling: Apache Airflow, Oozie, cron</li></ul><p>Data Pipeline</p><ul><li>DBì™€ ì—°ê²°í•˜ì—¬ ëª¨ë“  ë°ì´í„° Extract, Transform</li><li>Spark ê°™ì€ cluster computing frameworkë¥¼ ì‚¬ìš©í•˜ì—¬ analytical DBì— Load</li><li>Airflowì™€ ê°™ì€ scheduling frameworkë¥¼ í†µí•´ íŠ¹ì • ìˆœì„œë¡œ ì‹¤í–‰ë˜ë„ë¡ scheduling</li><li>sourceê°€ ì™¸ë¶€ API ë˜ëŠ” ê¸°íƒ€ íŒŒì¼ í˜•ì‹ì¼ ìˆ˜ë„ ìˆìŒ</li></ul><p>Data processing in the cloud</p><ul><li>ê³¼ê±°ì—ëŠ” ìì²´ ë°ì´í„° ì„¼í„°ë¥¼ ì„¤ë¦½í•˜ì—¬ ì„œë²„ ë™ì„ ì‚¬ìš©<ul><li>ì „ê¸° ìš”ê¸ˆ, ìœ ì§€ê´€ë¦¬ ë¹„ìš©</li><li>í”¼í¬ íƒ€ì„ì— ì¶©ë¶„í•œ ì²˜ë¦¬ ëŠ¥ë ¥ í•„ìš” -&gt; ì‚¬ìš©ì´ ì—†ì„ ë•ŒëŠ” ì²˜ë¦¬ ëŠ¥ë ¥ì´ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆìŒ -&gt; ë¦¬ì†ŒìŠ¤ ë‚­ë¹„</li><li>ì¬ë‚œì„ ëŒ€ë¹„í•´ ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ì§€ë¦¬ì  ìœ„ì¹˜ì— ë³µì œ í•„ìš”</li></ul></li><li>í´ë¼ìš°ë“œ<ul><li>ë¦¬ì†ŒìŠ¤ë¥¼ í•„ìš”í•  ë•Œ ì‚¬ìš©</li><li>ë¹„ìš© ìµœì í™”</li><li>DB ì•ˆì •ì„± -&gt; ì¬ë‚œ ê°™ì€ ìµœì•…ì˜ ìƒí™©ì— ëŒ€ë¹„</li></ul></li></ul><p>AWS, Azure, GCP</p><ul><li>2017 AWS ì¤‘ë‹¨ ë°œìƒ</li><li>2018 ê¸°ì¤€ ì ìœ ìœ¨: AWS &gt; Azure &gt; GCP</li></ul><p>Storage</p><ul><li>ëª¨ë“  ìœ í˜• íŒŒì¼ í´ë¼ìš°ë“œì— ì—…ë¡œë“œ</li><li>ì¼ë°˜ì ìœ¼ë¡œ ë§¤ìš° ì €ë ´</li><li>íŒŒì¼ ì•ˆì •ì ìœ¼ë¡œ ì €ì¥</li><li>AWS S3, Azure Blob Storage, Google Cloud Storage</li></ul><p>Computation</p><ul><li>í´ë¼ìš°ë“œì—ì„œ ê³„ì‚° ìˆ˜í–‰</li><li>ê°€ìƒë¨¸ì‹ ì„ ì›í•˜ëŠ”ëŒ€ë¡œ ì‚¬ìš© -&gt; í•„ìš”ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì‹œì‘, ì¤‘ì§€<ul><li>e.g. ì›¹ ì„œë²„ í˜¸ìŠ¤íŒ…</li></ul></li><li>AWS EC2, Azure Virtual Machines, Google Compute Engine</li></ul><p>Database</p><ul><li>DB í˜¸ìŠ¤íŒ…</li><li>AWS RDS, Azure SQL Database, Google Cloud SQL</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-engineering-toolbox">Data engineering toolbox<a href="#data-engineering-toolbox" class="hash-link" aria-label="Data engineering toolboxì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="Data engineering toolboxì— ëŒ€í•œ ì§ì ‘ ë§í¬">â€‹</a></h2><p>Database ì •ì˜</p><ul><li>ë°ì´í„° ë³´ìœ </li><li>ë°ì´í„° êµ¬ì„±</li><li>DBMSë¥¼ í†µí•´ ë˜ì°¾ì•„ì˜¤ê±°ë‚˜ ê²€ìƒ‰í•˜ëŠ” ë° ë„ì›€ì´ ë¨ </li></ul><p>DBì™€ File system ì°¨ì´</p><ul><li>DB<ul><li>ë§¤ìš° ì¡°ì§í™”ë˜ì–´ ìˆìŒ</li><li>ê²€ìƒ‰, ë³µì œ ë“±ê³¼ ê°™ì€ ë³µì¡í•œ ì‘ì—…ë“¤ì„ ì¶”ìƒí™”</li></ul></li><li>File system<ul><li>ëœ ì¡°ì§í™”ë˜ì–´ ìˆìŒ</li><li>ìœ„ì™€ ê°™ì€ ê¸°ëŠ¥ë“¤ì´ ê°„ë‹¨í•˜ê±°ë‚˜ ëœí•¨</li></ul></li></ul><p>Structured and unstructured data</p><ul><li>Structured: database schema<ul><li>RDBMSì˜ í…Œì´ë¸” í˜•ì‹ ë°ì´í„°</li></ul></li><li>Semi-structured<ul><li>JSON</li></ul></li><li>Unstructured: shemaless, íŒŒì¼ê³¼ ë” ë¹„ìŠ·í•¨<ul><li>ë¹„ë””ì˜¤, ì‚¬ì§„</li></ul></li></ul><p>SQL and NoSQL</p><ul><li>SQL<ul><li>Tables</li><li>Database schema: í…Œì´ë¸” ê°„ì˜ ê´€ê³„, ì†ì„± ì •ì˜</li><li>RDBMS(Relational DataBase Management System)</li><li>Mysql, PostgreSQL</li></ul></li><li>NoSQL<ul><li>Non-relational database</li><li>NoSQL DBì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ìœ í˜•ì´ ìˆìŒ<ul><li>unstructured dataë§Œ ì—°ê²°ë˜ëŠ” ê²ƒì´ ì•„ë‹˜ -&gt; structured dataë„ ì—°ê²°ë  ìˆ˜ ìˆìŒ</li></ul></li><li>Key-value ì €ì¥(e.g. caching, ë¶„ì‚° êµ¬ì¡°)</li><li>Document DB(e.g. JSON object -&gt; structured or unstructured object)</li><li>Redis, MongoDB</li></ul></li></ul><p>database schema</p><ul><li><p>DBì˜ êµ¬ì¡°ì™€ ê´€ê³„ ì„¤ëª… </p></li><li><p>e.g. ìŠ¤í‚¤ë§ˆ í…Œì´ë¸” ìƒì„±</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">-- Create Customer Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;customer&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SERIAL</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;first_name&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;last_name&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">-- Create Order Table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Order&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SERIAL</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;customer_id&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">integer</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REFERENCES</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Customer&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;product_name&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;product_price&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">integer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>customer_idë¡œ ì£¼ë¬¸ì„ ê³ ê°ê³¼ ì—°ê²° -&gt; foreign key</li><li>JOIN ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì™¸ë˜ í‚¤ í™œìš©<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Customer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">JOIN</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Order&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ON</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;customer_id&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Customer&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul><p>Star schema</p><ul><li>data warehousingì—ì„œ ìì£¼ ë³¼ ìˆ˜ ìˆìŒ</li><li>Redshiftì™€ ê°™ì€ ë§ì€ ë¶„ì„ DBì—ì„œ ìŠ¤í‚¤ë§ˆì— ëŒ€í•œ ìµœì í™” ì¡´ì¬</li><li>ìŠ¤íƒ€ ìŠ¤í‚¤ë§ˆëŠ” ì—¬ëŸ¬ ì°¨ì› í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ëŠ” í•˜ë‚˜ ì´ìƒì˜ fact tableë¡œ êµ¬ì„±</li><li>Fact tableì—ëŠ” ì„¸ìƒì—ì„œ ì¼ì–´ë‚˜ëŠ” ì¼ë“¤ì„ í‘œí˜„í•˜ëŠ” record í¬í•¨ë˜ì–´ ìˆìŒ<ul><li>e.g. orders</li></ul></li><li>Dimension tableì€ ì„¸ê³„ ìì²´ì— ëŒ€í•œ ì •ë³´<ul><li>e.g. customer information </li></ul></li></ul><p>The database schema</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the SELECT statement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">SELECT first_name, last_name FROM &quot;Customer&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">ORDER BY last_name, first_name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Show the first 3 rows of the DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Show the info of the DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Joining on relations</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the SELECT statement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">data </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">SELECT * FROM &quot;Customer&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">INNER JOIN &quot;Order&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">ON &quot;Order&quot;.&quot;customer_id&quot;=&quot;Customer&quot;.&quot;id&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Show the id column of data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>parallel computing</p><ul><li>ê±°ì˜ ëª¨ë“  ìµœì‹  ë°ì´í„° ì²˜ë¦¬ ë„êµ¬ì˜ ê¸°ì´ˆë¥¼ í˜•ì„±</li><li>ë³‘ë ¬ ì»´í“¨íŒ…ì´ ì¤‘ìš”í•œ ì´ìœ <ul><li>ë©”ëª¨ë¦¬  <ul><li>ë©”ëª¨ë¦¬ì— ëª¨ë“  ë°ì´í„°ë¥¼ ë¡œë“œí•  í•„ìš” ì—†ìŒ</li><li>datasetì„ ë¶„í• í•˜ì—¬ ë‹¤ë¥¸ ì»´í“¨í„°ì˜ ë©”ëª¨ë¦¬ì— ë¡œë“œ -&gt; ì»´í“¨í„° ë‹¹ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë‚®ì¶¤</li><li>ê° ì»´í“¨í„°ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì´ ìƒëŒ€ì ìœ¼ë¡œ ì‘ìŒ</li><li>RAMì— ê°€ê¹Œìš´ ë©”ëª¨ë¦¬ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆìŒ</li></ul></li><li>ì²˜ë¦¬ ëŠ¥ë ¥<ul><li>ì—¬ëŸ¬ ê°œì˜ ì‘ì€ í•˜ìœ„ ì‘ì—…ë“¤ë¡œ ë¶„í•  -&gt; ì—¬ëŸ¬ ì»´í“¨í„°ì— ë°°í¬<ul><li>ë„ë¦¬ ì‚¬ìš© ê°€ëŠ¥, ìƒëŒ€ì ìœ¼ë¡œ ì €ë ´</li></ul></li><li>ê°œë³„ì ìœ¼ë¡œëŠ” ì „ì²´ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¬ì§€ë§Œ ë” ì‘ì€ í•˜ìœ„ ì‘ì—…ì—ì„œ ë³‘ë ¬ë¡œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— ì „ì²´ ì‘ì—…ì´ ë” ë¹ ë¥´ê²Œ ìˆ˜í–‰ë¨</li><li>ì—¬ëŸ¬ ê°œì˜ processing unitì„ ê°€ì§€ë©´ ì²˜ë¦¬ ëŠ¥ë ¥ í–¥ìƒ</li></ul></li></ul></li><li>ë³‘ë ¬ì»´í“¨íŒ…ì€ ë¹„ìš©ì´ ë“¤ ìˆ˜ ìˆìŒ<ul><li>í•˜ìœ„ ì‘ì—…ìœ¼ë¡œ ë¶„í• , í•˜ìœ„ ì‘ì—…ì˜ ê²°ê³¼ ë³‘í•© ê³¼ì •ì—ì„œ communication cost ë°œìƒ</li><li>ì²˜ë¦¬ ìš”êµ¬ì‚¬í•­ì´ ë§ì§€ ì•Šê±°ë‚˜ processing unitì´ ë„ˆë¬´ ì ì€ ê²½ìš° communication ovearheadëŠ” ë³‘ëª©í˜„ìƒ(bottleneck)ì´ ì¼ì–´ë‚¨<ul><li>overhead: ì–´ë–¤ ì²˜ë¦¬ë¥¼ í•˜ê¸° ìœ„í•´ ë“¤ì–´ê°€ëŠ” ê°„ì ‘ì ì¸ ì²˜ë¦¬ ì‹œê°„, ë©”ëª¨ë¦¬ ë“±</li></ul></li><li>overhead ë•Œë¬¸ì— ë¶„í• í•  ë•Œ ì†ë„ê°€ ì„ í˜•ì ìœ¼ë¡œ ì¦ê°€í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ<ul><li>parallel slowdown</li></ul></li></ul></li></ul><p>multiprocessing.Pool</p><ul><li>low levelì—ì„œ multiprocessing.Pool</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> multiprocessing </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Pool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">take_mean_age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">year_and_group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    year</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> group </span><span class="token operator">=</span><span class="token plain"> year_and_group</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Age&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Age&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> index</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">year</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> Pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    results </span><span class="token operator">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">take_mean_age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> athlete_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Year&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># mapping -&gt; 4 seperate process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result_df </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">results</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ì—¬ëŸ¬ íŒ¨í‚¤ì§€ëŠ” ì´ëŸ¬í•œ ë‚®ì€ ìˆ˜ì¤€ì˜ ì½”ë“œë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ì—†ë„ë¡ ì¶”ìƒí™” ê³„ì¸µì„ ì œê³µ</p><ul><li><p>e.g. dask</p><ul><li><p>GROUPBY ìˆ˜í–‰, multiprocessing ì‚¬ìš©í•˜ëŠ” DataFrame ê°ì²´ ì œê³µ</p></li><li><p>Lazy evaluation ì‚¬ìš© -&gt; .compute() ë¶™ì„</p></li><li><p>Using a DataFrame</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> dask</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dataframe </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> dd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Partition dataframe into 4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">athlete_events_dask </span><span class="token operator">=</span><span class="token plain"> dd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">from_pandas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> npartitions</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run parallel computations on each partition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate the mean Age per Year</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result_df </span><span class="token operator">=</span><span class="token plain"> athlete_events_dask</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">compute</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul><p>From task to subtasks</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">## From task to subtasks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Function to apply a function over multiple cores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@print_timing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">parallel_apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">apply_func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> groups</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nb_cores</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> Pool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">nb_cores</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        results </span><span class="token operator">=</span><span class="token plain"> p</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">apply_func</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> groups</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">results</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parallel apply using 1 core</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parallel_apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">take_mean_age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> athlete_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parallel apply using 2 cores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parallel_apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">take_mean_age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> athlete_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parallel apply using 4 cores</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parallel_apply</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">take_mean_age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> athlete_events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Hadoop </p><ul><li>Apache Software Foundationì—ì„œ ìœ ì§€ê´€ë¦¬í•˜ëŠ” ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸</li><li>HDFS<ul><li>ë¶„ì‚° íŒŒì¼ ì‹œìŠ¤í…œ</li><li>íŒŒì¼ ì‹œìŠ¤í…œê³¼ ìœ ì‚¬</li><li>íŒŒì¼ì´ ë‹¤ë¥¸ ì»´í“¨í„°ë“¤ì— ì¡´ì¬</li><li>í™•ì¥ì— ì˜í•œ parallel computingì—ì„œëŠ” í•„ìˆ˜ì ì´ì—ˆìŒ</li><li>S3 ê°™ì€ storage systemì´ ì¢…ì¢… HDFSë¥¼ ëŒ€ì²´</li></ul></li><li>MapReduce<ul><li>ëŒ€ì¤‘í™” ëœ ìµœì´ˆì˜ ë¹…ë°ì´í„° ì²˜ë¦¬ íŒ¨ëŸ¬ë‹¤ì„ ì¤‘ í•˜ë‚˜</li><li>í•˜ìœ„ ì‘ì—…ìœ¼ë¡œ ë‚˜ëˆ„ê³  ì—¬ëŸ¬ processing unitì— workloadì™€ data ë¶„ë°° -&gt; computer cluster</li><li>ì‘ì—…ì„ ì‘ì„±í•˜ê¸° ì–´ë ¤ì›€ -&gt; Hiveë¡œ í•´ê²°</li><li>MapReduce ê¸°ë°˜ ì‹œìŠ¤í…œì€ ì‘ì—… ê°„ì— ê³ ê°€ì˜ ë””ìŠ¤í¬ ì“°ê¸°ê°€ í•„ìš” -&gt; MapReduceì˜ í•œê³„</li><li>MapReduceì˜ ë””ìŠ¤í¬ ì“°ê¸°ëŠ” ê° ë‹¨ê³„ê°€ ì´ì „ ë‹¨ê³„ ìœ„ì— êµ¬ì¶•ë˜ëŠ” interactiveí•œ EDA(Exploratory Data Analysis)ì—ì„œ ì œí•œì </li></ul></li></ul><p>Hive</p><ul><li>ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” Hadoop echo systemì˜ ìµœìƒìœ„ ê³„ì¸µ</li><li>Hive SQLì„ ì‚¬ìš©í•˜ì—¬ structured query<ul><li>parallel processingì„ ìœ„í•´ structured query ì‚¬ìš©</li></ul></li><li>Facebookì´ ê°œë°œí–ˆì§€ë§Œ ì´ì   Apache software Fondationì—ì„œ í”„ë¡œì íŠ¸ ìœ ì§€</li><li>ì²˜ìŒì—ëŠ” MapReduceë¡œ Hiveë¥¼ ì‹¤í–‰í–ˆì§€ë§Œ ì§€ê¸ˆì€ ë‹¤ë¥¸ ë°ì´í„° ì²˜ë¦¬ ë„êµ¬ì™€ í†µí•©ë¨</li><li>e.g.<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">year</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">AVG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> views</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">athlete_events</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">year</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>ì¼ë°˜ sqlê³¼ ë‹¤ë¥¸ ê²ƒì´ ì—†ì–´ ë³´ì´ì§€ë§Œ ë’¤ì—ì„œëŠ” clusterì—ì„œ ì‘ë™í•  ìˆ˜ ìˆëŠ” ì‘ì—…ìœ¼ë¡œ ë³€í™˜ë¨</li><li>Hive -&gt; MapReduce -&gt; cluster</li></ul></li></ul><p>Spark</p><ul><li>computer clusterê°„ì— ë°ì´í„° ì²˜ë¦¬ ì‘ì—…ì„ ë¶„ì‚°ì‹œí‚´</li><li>SparkëŠ” ë©”ëª¨ë¦¬ì—ì„œ ê°€ëŠ¥í•œ ë§ì€ ì²˜ë¦¬ë¥¼ í•˜ë ¤ê³  í•¨ -&gt; MapReduce í•œê³„ í•´ê²°</li><li>UC Berkeley AMPLabì—ì„œ ê°œë°œ, í˜„ì¬ëŠ” Apache Software Foundationì—ì„œ ìœ ì§€ê´€ë¦¬</li></ul><p>Resilient distributed datasets(RDD)</p><ul><li>ìŠ¤íŒŒí¬ê°€ ì˜ì¡´</li><li>ì—¬ëŸ¬ ë…¸ë“œ ê°„ì˜ ë¶„ì‚°ëœ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ëŠ” ìë£Œêµ¬ì¡°</li><li>DataFrameê³¼ ë‹¤ë¥´ê²Œ ì—´ì— ì´ë¦„ì´ ì—†ìŒ -&gt; tupleê³¼ ë¹„ìŠ·í•¨</li><li>Operation<ul><li>Transformation: map() or filter()</li><li>Action: count() or first()</li></ul></li></ul><p>Pyspark</p><ul><li>Sparkì— ëŒ€í•œ python interface</li><li>DataFrame abstraction í˜¸ìŠ¤íŠ¸<ul><li>pandasì˜ DataFrameê³¼ ë¹„ìŠ·í•˜ê²Œ ì‚¬ìš©</li></ul></li><li>ë³µì¡í•œ parallel computing operation ì²˜ë¦¬</li><li>e.g.<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Load the dataset into athlete_events_spark first</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events_spark</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupBy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Age&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>PySpark groupby</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Print the type of athlete_events_spark</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events_spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Print the schema of athlete_events_spark</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events_spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">printSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Group by the Year, and find the mean Age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events_spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupBy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Age&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Group by the Year, and find the mean Age</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">athlete_events_spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupBy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Year&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;Age&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example pipeline</p><ul><li>csv ì¶”ì¶œ, sparkë¡œ clean, sql load</li><li>How to schedule?<ul><li>ìˆ˜ë™ìœ¼ë¡œ ì‘ì—… ì‹¤í–‰</li><li>Linux cron ê°™ì€ scheduling tool ì‚¬ìš©</li></ul></li><li>CSV íŒŒì¼ ì‘ì—…, APIë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ cleaní•˜ëŠ” ì‘ì—…, ë°ì´í„°ë¥¼ joiní•˜ëŠ” ì‘ì—…<ul><li>ì‘ì—…ì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ìƒê¹€ -&gt; DAG(Directed Acyclic Graph)ë¡œ ì˜ì¡´ì„± ì‹œê°í™”</li></ul></li></ul><p>DAG(Directed Acyclic Graph)</p><ul><li>directed edgeë¡œ ì—°ê²°ëœ nodeë“¤ì˜ ì§‘í•©</li><li>cycleì´ ì—†ëŠ” graph<ul><li>íŠ¹ì • ë…¸ë“œê°€ ë‘ë²ˆ ì´ìƒ í‘œì‹œX</li></ul></li></ul><p>ìœ„ì˜ ì‘ì—…ì— ëŒ€í•œ tool</p><ul><li><p>Linuxì˜ cron</p></li><li><p>Spotifyì˜ Luigi</p><ul><li>ë³µì¡í•œ íŒŒì´í”„ë¼ì¸ì— ëŒ€í•´ DAGë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŒ</li></ul></li><li><p>Apache Airflow</p><ul><li><p>ì‚¬ì‹¤ìƒ workflow scheduling framework</p></li><li><p>Airbnbê°€ workflow ê´€ë¦¬ë¥¼ ìœ„í•´ ë§Œë“¬</p></li><li><p>2015 ì˜¤í”ˆ ì†ŒìŠ¤ë¡œ ê³µê°œ, 2016ë…„ Apache Software Foundationì— ê°€ì…</p></li><li><p>íŒŒì´ì¬ì„ ì‚¬ìš©í•˜ì—¬ ë³µì¡í•œ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” DAGë¥¼ ë§Œë“¤ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŒ</p></li><li><p>e.g.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create the DAG object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;example_dag&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 * * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Define operations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">start_cluster </span><span class="token operator">=</span><span class="token plain"> StartClusterOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;start_cluster&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ingest_customer_data </span><span class="token operator">=</span><span class="token plain"> SparkJobOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ingest_customer_data&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ingest_product_data </span><span class="token operator">=</span><span class="token plain"> SparkJobOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ingest_product_data&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">enrich_customer_data </span><span class="token operator">=</span><span class="token plain"> PythonOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;enrich_customer_data&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set up dependency flow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">start_culster</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ingest_customer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ingest_customer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">enrich_customer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ingest_product_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">enrich_customer_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul><p>Airflow DAGs</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create the DAG object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;car_factory_simulation&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          default_args</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;owner&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;airflow&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;start_date&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dates</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">days_ago</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 * * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Task definitions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assemble_frame </span><span class="token operator">=</span><span class="token plain"> BashOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;assemble_frame&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bash_command</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;echo &quot;Assembling frame&quot;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">place_tires </span><span class="token operator">=</span><span class="token plain"> BashOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;place_tires&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bash_command</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;echo &quot;Placing tires&quot;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assemble_body </span><span class="token operator">=</span><span class="token plain"> BashOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;assemble_body&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bash_command</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;echo &quot;Assembling body&quot;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">apply_paint </span><span class="token operator">=</span><span class="token plain"> BashOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;apply_paint&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> bash_command</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;echo &quot;Applying paint&quot;&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the downstream flow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assemble_frame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">place_tires</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assemble_frame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">assemble_body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">assemble_body</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_downstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">apply_paint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extract-transform-and-loadetl">Extract, Transform and Load(ETL)<a href="#extract-transform-and-loadetl" class="hash-link" aria-label="Extract, Transform and Load(ETL)ì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="Extract, Transform and Load(ETL)ì— ëŒ€í•œ ì§ì ‘ ë§í¬">â€‹</a></h2><p>Extracting data</p><ul><li>ë°ì´í„° ì²˜ë¦¬ì— ì í•©í•˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ S3 ê°™ì€ ì„œë¹„ìŠ¤ ë˜ëŠ” DBì—ì„œ ë©”ëª¨ë¦¬ë¡œ ì¶”ì¶œ</li><li>Plain text file</li><li>Flat file<ul><li>ê° rowê°€ record, ê° columnì´ record atrribute</li><li>tarbular format</li><li>csv, tsv</li></ul></li><li>JSON(JavaScript Object Notation)<ul><li>Semi-structured</li><li>Atomic<ul><li>number</li><li>string</li><li>boolean</li><li>null</li></ul></li><li>Composite<ul><li>array</li><li>object</li></ul></li><li>íŒŒì´ì¬ dictì™€ mappging -&gt; <code>import json</code></li></ul></li></ul><p>Data on the web</p><ul><li><p>request, response</p></li><li><p>e.g.</p><ol><li>Browse to Google</li><li>Request to Google Server</li><li>Google responds with web page</li></ol></li><li><p>ì‚¬ëŒì´ ì½ê¸° í˜ë“  ì›¹ í˜ì´ì§€ë„ ì¡´ì¬</p><ul><li><p>JSON format</p></li><li><p>ì„œë²„ API(Application Programming Interface)</p><ul><li><p>e.g.</p><ul><li><p>twitterëŠ” JSON í˜•ì‹ìœ¼ë¡œ íŠ¸ìœ—ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” API í˜¸ìŠ¤íŒ…</p></li><li><p>Hackernews API</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://hacker-news.firebaseio.com/v0/item/16222426.json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul></li></ul></li></ul><p>Database</p><ul><li>ì¼ë°˜ì ì¸ ë°ì´í„° ì¶”ì¶œ ë°©ë²• -&gt; ê¸°ì¡´ application DBì—ì„œ ì¶”ì¶œ</li><li>ëŒ€ë¶€ë¶„ì˜ applicationì—ëŠ” ë°ì´í„°ë¥¼ ë°±ì—…, ìœ ì§€í•˜ê¸° ìœ„í•´ DBê°€ í•„ìš”</li><li>Applications databases<ul><li>applicationì´ ì‚¬ìš©í•˜ëŠ” DBëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë§ì€ Transaction ê°€ì§€ë„ë¡ ìµœì í™” ë˜ì–´ìˆìŒ</li><li>DBì—ì„œ row ë˜ëŠ” recordë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ì‚½ì…</li><li>OLTP(Online transaction processing)</li><li>row-oriented, ì‹œìŠ¤í…œì´ í–‰ë³„ë¡œ ë°ì´í„°ë¥¼ ì¶”ê°€</li></ul></li><li>Analytical databases<ul><li>ë¶„ì„ì— ìµœì í™” ëœ DB</li><li>OLAP(Online Analyticall processing)</li><li>Colum-oriented</li></ul></li></ul><p>Extraction from database</p><ul><li><p>Connection string/URI</p><ul><li>DBì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ì •ë³´ë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ìì—´ </li><li>e.g. PostgreSQL<ul><li><code>postgresql://[user[:password]@][host][:port]</code></li></ul></li></ul></li><li><p>Python</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import sqlalchemy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection_uri = &quot;postgresql://repl:password@localhost:5432/pagila&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engine = sqlalchemy.create_engine(connection_uri)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pd.real_sql(&quot;SELECT * FROM customer&quot;, db_engine)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>Fetch from an API</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Fetch the Hackernews post</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">resp </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;https://hacker-news.firebaseio.com/v0/item/16222426.json&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Print the response parsed as JSON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">resp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Assign the score of the test to post_score</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">post_score </span><span class="token operator">=</span><span class="token plain"> resp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;score&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">post_score</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read from a database</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Function to extract table to a pandas DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">extract_table_to_pandas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    query </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT * FROM {}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Connect to the database using the connection URI</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection_uri </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://repl:password@localhost:5432/pagila&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engine </span><span class="token operator">=</span><span class="token plain"> sqlalchemy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">create_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">connection_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract the film table into a pandas DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">extract_table_to_pandas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;film&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract the customer table into a pandas DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">extract_table_to_pandas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;customer&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ì–´ë–¤ ì¢…ë¥˜ì˜ ë³€í™˜ì„ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ”ê°€</p><ul><li><p>ì†ì„±ì„ ì„ íƒ </p></li><li><p>ì½”ë“œ ê°’ ë²ˆì—­</p></li><li><p>ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬</p></li><li><p>ë‹¨ì¼ ì—´ì„ ì—¬ëŸ¬ ì—´ë¡œ split</p><ul><li><p>e.g. ì´ë©”ì¼ì„ ì•„ì´ë””ì™€ ë„ë©”ì¸ìœ¼ë¡œ ë¶„ë¦¬</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">customer_df </span><span class="token comment" style="color:rgb(98, 114, 164)"># Pandas DataFrame with customer data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Split email column into 2 columns on the &#x27;@&#x27; symbol</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">split_email </span><span class="token operator">=</span><span class="token plain"> customer_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">email</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;@&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> expand</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Create 2 new columns using the resulting DataFrame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">customer_df </span><span class="token operator">=</span><span class="token plain"> customer_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">assign</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  username</span><span class="token operator">=</span><span class="token plain">split_email</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  domail</span><span class="token operator">=</span><span class="token plain">split_email</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>ì—¬ëŸ¬ sourceì—ì„œ join</p><ul><li><p>e.g. Pyspark</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">customer_df </span><span class="token comment" style="color:rgb(98, 114, 164)"># PySpark DataFrame with customer data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ratings_df </span><span class="token comment" style="color:rgb(98, 114, 164)"># PySpark DataFrame with ratings data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Groupby ratings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ratings_per_customer </span><span class="token operator">=</span><span class="token plain"> ratings_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupBy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;customer_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rating&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Join on customer ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">customer_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ratings_per_customer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  customer_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">customer_id</span><span class="token operator">==</span><span class="token plain">ratings_per_customer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">customer_id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li></ul><p>Transforming in PySpark</p><ul><li><p>loadê°€ ì ìœ¼ë©´ pandasë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŒ</p></li><li><p>PySparkë¥¼ ì‚¬ìš©í•˜ë©´ Extract ë‹¨ê³„ì—ì„œ tableì„ Sparkì— load</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sql</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark </span><span class="token operator">=</span><span class="token plain"> pyspark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">SparkSession</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">builder</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">getOrCreate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">spark</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">jdbc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;jdbc:postgresql://localhost:5432/pagila&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;customer&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                properties</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;repl&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;password&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>JDBCëŠ” Sparkê°€ ì—¬ëŸ¬ RDBMSì— ì—°ê²°í•˜ëŠ”ë° ë„ì™€ì£¼ëŠ” ì†Œí”„íŠ¸ì›¨ì–´</li></ul></li></ul><p>Splitting</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Get the rental rate column as a string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rental_rate_str </span><span class="token operator">=</span><span class="token plain"> film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rental_rate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Split up and expand the column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rental_rate_expanded </span><span class="token operator">=</span><span class="token plain"> rental_rate_str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;.&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> expand</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Assign the columns to film_df</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_df </span><span class="token operator">=</span><span class="token plain"> film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">assign</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rental_rate_dollar</span><span class="token operator">=</span><span class="token plain">rental_rate_expanded</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rental_rate_cents</span><span class="token operator">=</span><span class="token plain">rental_rate_expanded</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Joining</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Use groupBy and mean to aggregate the column</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ratings_per_film_df = rating_df.groupBy(&#x27;film_id&#x27;).mean(&#x27;rating&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Join the tables using the film_id column</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_df_with_ratings = film_df.join(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ratings_per_film_df,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    film_df.film_id==ratings_per_film_df.film_id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Show the 5 first results</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print(film_df_with_ratings.show(5))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Analytics or applications databases</p><ul><li>Analytics<ul><li>ë³µì¡í•œ ì§‘ê³„ ì¿¼ë¦¬ëŠ” ë¶„ì„ DBì—ì„œ ìì£¼ ì‹¤í–‰ -&gt; ìµœì í™” í•„ìš”</li><li>OLAPìœ„í•´ ìµœì í™”</li><li>Column-oriented<ul><li>column ë‹¹ ë°ì´í„°ë¥¼ ì €ì¥í•˜ë©´ íŠ¹ì • ì—´ì„ loopì‹œì¼œ queryí•˜ëŠ” ê²ƒì´ ë” ë¹ ë¦„</li><li>parallelizationì— ë” ì í•©</li></ul></li></ul></li><li>Application<ul><li>ì´ˆë‹¹ transactionì´ ë§ìŒ -&gt; ìµœì í™” í•„ìš”</li><li>OLTPìœ„í•´ ìµœì í™”</li><li>Row-oriented<ul><li>record ë‹¹ ë°ì´í„°ë¥¼ ì €ì¥ -&gt; ì†Œê·œëª¨ transactionì—ì„œ ìƒˆ rowë¥¼ ì‰½ê²Œ ì¶”ê°€</li></ul></li></ul></li></ul><p>MPP DB(Massively Parallel Processing Database)</p><ul><li>ETL í”„ë¡œì„¸ìŠ¤ê°€ ëë‚  ë•Œ ëŒ€ìƒì´ ë˜ëŠ” DB ìœ í˜•</li><li>ë¶„ì‚° ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ë¶„ì„ì— ìµœì í™” ëœ column-oriented DB</li><li>QueryëŠ” ë‹¨ì¼ ì»´í“¨íŒ… ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•˜ìœ„ ì‘ì—…ìœ¼ë¡œ ë¶„í• ë˜ì–´ ì—¬ëŸ¬ ë…¸ë“œì— ë¶„ì‚°</li><li>Amazon Redshift, Azure SQL Data Warehouse, Google BigQuery</li><li>ì¼ë°˜ì ìœ¼ë¡œ column-oriented formatì„ ì‚¬ìš©í•˜ëŠ” íŒŒì¼ì—ì„œ ì˜ load</li></ul><p>Redshift</p><ul><li>S3ì— íŒŒì¼ì„ ì“°ê³  Redshiftì— ë³µì‚¬ queryë¥¼ ë³´ëƒ„</li><li>e.g.<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Pandas .to_parquet() method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_parquet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./s3://path/to/bucket/customer.parquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># PySpark .write.parquet() method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parquet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;./s3://path/to/bucket/customer.parquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>PostgreSQL connection URIë¥¼ ì‚¬ìš©í•˜ì—¬ Redshiftì— ì—°ê²°, S3ì˜ ë°ì´í„°ë¥¼ Redshiftë¡œ ë³µì‚¬</li></ul><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">COPY customer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;s3://path/to/bucket/customer.parquet&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FORMAT </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> parquet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>Load to PostgreSQL</p><ul><li><p>pandas.to_sql()</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Transformation on data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recommendations </span><span class="token operator">=</span><span class="token plain"> transform_find_recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ratings_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Load into PostgreSQL database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                       db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">schema</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;store&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                       if_exitsts</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replace&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>Writing to a file</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Write the pandas DataFrame to parquet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_pdf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_parquet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;films_pdf.parquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Write the PySpark DataFrame to parquet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_sdf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">parquet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;films_sdf.parquet&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Load into Postgres</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Finish the connection URI</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection_uri </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://repl:password@localhost:5432/dwh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engine_dwh </span><span class="token operator">=</span><span class="token plain"> sqlalchemy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">create_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">connection_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Transformation step, join with recommendations data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_pdf_joined </span><span class="token operator">=</span><span class="token plain"> film_pdf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Finish the .to_sql() call to write to store.film</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">film_pdf_joined</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;film&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> schema</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;store&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> if_exists</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replace&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run the query to fetch the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT film_id, recommended_film_ids FROM store.film&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The ETL function</p><ul><li><p>ETL ë™ì‘ì„ <code>elt()</code> í•¨ìˆ˜ë¡œ ìº¡ìŠí™”</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># PostgreSQL tableì„ pandas DataFrameìœ¼ë¡œ extractí•˜ëŠ” í•¨ìˆ˜</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">extract_table_to_dfd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT * FROM {}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ë¶„ì„ì— ë” ì í•©í•œ í˜•ì‹ìœ¼ë¡œ transform</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">split_columns_transform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> column</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> suffixes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Converts column into str and splits it on pat...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ë³€í™˜ëœ ë°ì´í„°ë¥¼ PostgreSQL DBì— load</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">load_df_into_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tablename</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> schema</span><span class="token operator">=</span><span class="token plain">schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> if_exists</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replace&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engines </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># Needs to be configured</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  film_df </span><span class="token operator">=</span><span class="token plain"> extract_table_to_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;film&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;store&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Transform</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  film_df </span><span class="token operator">=</span><span class="token plain"> split_columns_transform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;renntal_rate&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;_dollar&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;_cents&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Load</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  load_df_into_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;film&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;store&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dwh&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>Airflow</p><ul><li><p>íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰ë˜ë„ë¡ í•¨</p></li><li><p>pythonìœ¼ë¡œ ì‘ì„±ëœ workflow scheduler</p></li><li><p>Python ê°ì²´ì—ì„œ DAG ì‚¬ìš©</p></li><li><p>DAG task ì‚¬ì´ì— ì˜ì¡´ì„± ê´€ê³„ê°€ ìˆì„ ìˆ˜ ìˆê¸°ì— workflowë¥¼ ê´€ë¦¬í•˜ëŠ” ë° ì™„ë²½</p></li><li><p>operatorëŠ” ì‘ì—…ë‹¨ìœ„ë¥¼ ë‚˜íƒ€ëƒ„</p><ul><li>ë‹¤ì–‘í•œ ì¢…ë¥˜ê°€ ìˆìœ¼ë©° custom operatorë„ ì“¸ ìˆ˜ ìˆìŒ</li></ul></li><li><p>Scheduling with DAGs in Airflow</p><ul><li>DAG ê°ì²´ ë§Œë“¤ê¸°</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">frorm airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> DAG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sample&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 0 * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># DAGë¥¼ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ì‹œê¸°ë¥¼ ì •ì˜</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>ì¼ë°˜ì ìœ¼ë¡œ cron í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ ê°„ê²©ì„ ì •ì˜<ul><li>minute(0~59), hour(0~23), day of the month(1~31), month(1~12), day of the week(0~6)<ul><li>e.g. 0 * * * * -&gt; ë§¤ ì‹œê°„ 0ë¶„</li></ul></li></ul></li></ul></li><li><p>The DAG definition file</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> DAG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">operators</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">python_operator </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> PythonOperator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;etl_pipeline&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 0 * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">etl_task </span><span class="token operator">=</span><span class="token plain"> PythonOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;etl_task&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          python_callable</span><span class="token operator">=</span><span class="token plain">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">etl_task</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_upstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wait_for_this_task</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>etl_dag.py</code>ì„ <code>~/airflow/dags/</code>ì— ì €ì¥</li></ul></li></ul><p>Defining a DAG</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Define the ETL function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    film_df </span><span class="token operator">=</span><span class="token plain"> extract_film_to_pandas</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    film_df </span><span class="token operator">=</span><span class="token plain"> transform_rental_rate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    load_dataframe_to_film</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">film_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Define the ETL task using PythonOperator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">etl_task </span><span class="token operator">=</span><span class="token plain"> PythonOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;etl_film&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          python_callable</span><span class="token operator">=</span><span class="token plain">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                          dag</span><span class="token operator">=</span><span class="token plain">dag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set the upstream to wait_for_table and sample run etl()</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">etl_task</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_upstream</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wait_for_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="case-study-datacamp">Case Study: DataCamp<a href="#case-study-datacamp" class="hash-link" aria-label="Case Study: DataCampì— ëŒ€í•œ ì§ì ‘ ë§í¬" title="Case Study: DataCampì— ëŒ€í•œ ì§ì ‘ ë§í¬">â€‹</a></h2><p>Ratings at DataCamp</p><ul><li>í•œ ì¥ì´ ëë‚˜ë©´ ì™„ë£Œ í›„ í‰ê°€</li><li>íŠ¹ì • ê³¼ì •ì„ í‰ê°€í•˜ëŠ” ë°©ë²•ì„ ì¶”ì • -&gt; ì¶”ì²œ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ê¸° ì í•©</li><li>ë“±ê¸‰ ë°ì´í„°ë¥¼ clean ì‘ì—… í›„ ê° ì‚¬ìš©ìì—ê²Œ ê¶Œì¥í•˜ëŠ” ìƒìœ„ ê³¼ì • ê³„ì‚°</li><li>ë§¤ì¼ ë‹¤ì‹œ ê³„ì‚° -&gt; dashboardì— ê³¼ì • í‘œì‹œ</li></ul><p>ETL process</p><ul><li>extract rating data<ul><li>datacapmp_application DBì˜ ë‘ SQL tableì—ì„œ extract ìˆ˜í–‰ -&gt; PostgreSQL</li></ul></li><li>ìœ ìš©í•œ recommendationì„ ì–»ê¸° ìœ„í•œ transform<ul><li>clean, rating tableì—ì„œ recommendationì„ ê³„ì‚°í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜</li></ul></li><li>load application database <ul><li>data warehouse DBì— load</li></ul></li><li>data scientistëŠ” recommendationì„ ì œê³µ</li><li>data engineerëŠ” scheduleì— ë§ê²Œ recommendationì„ ì—…ë°ìíŠ¸í•˜ëŠ” ì•ˆì •ì ì¸ ì‹œìŠ¤í…œ êµ¬ì¶•</li></ul><p>Table</p><ul><li>Course<ul><li>course_id(foreign key), title, description, programming_language</li></ul></li><li>Rating<ul><li>user_id(identifier), course_id, rating</li></ul></li></ul><p>Querying the table</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the connection URI</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection_uri </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://repl:password@localhost:5432/datacamp_application&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engine </span><span class="token operator">=</span><span class="token plain"> sqlalchemy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">create_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">connection_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get user with id 4387</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user1 </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT * FROM rating WHERE user_id=4387&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get user with id 18163</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user2 </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT * FROM rating WHERE user_id=18163&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get user with id 8770</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user3 </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;SELECT * FROM rating WHERE user_id=8770&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use the helper function to compare the 3 users</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print_user_comparison</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">user1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> user2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> user3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Average rating per course</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the transformation function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transform_avg_rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Group by course_id and extract average rating per course</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    avg_rating </span><span class="token operator">=</span><span class="token plain"> rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;course_id&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Return sorted average ratings per course</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sort_rating </span><span class="token operator">=</span><span class="token plain"> avg_rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ascending</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> sort_rating</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract the rating data into a DataFrame    </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rating_data </span><span class="token operator">=</span><span class="token plain"> extract_rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use transform_avg_rating on the extracted data and print results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">avg_rating_data </span><span class="token operator">=</span><span class="token plain"> transform_avg_rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">avg_rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The recommendations table</p><ul><li>user_id, course_id, rating prediction<ul><li>rating prediction: ë“±ê¸‰ ì˜ˆì¸¡ì„ í†µí•´ ì‚¬ìš©ìê°€ ì½”ìŠ¤ë¥¼ ìˆ˜ê°•í•˜ê¸° ì „ì— ë“±ê¸‰ì„ ì¶”ì •</li></ul></li><li>tripletì€ rating tableì—ì„œ ê° uniqueí•œ user idì— ëŒ€í•œ ì¶”ì²œ ì½”ìŠ¤ top 3ë¡œ êµ¬ì„±<ul><li>ìœ ìš©í•¨<ul><li>recommendation tableì— accessí•  ìˆ˜ ìˆëŠ” ì‘ìš© í”„ë¡œê·¸ë¨ì´ íŠ¹ì • ì‚¬ìš©ìì— ëŒ€í•´ query</li><li>ì¶”ì²œí•  3ê°œì˜ ì½”ìŠ¤ë¥¼ ì¦‰ì‹œ ì–»ì„ ìˆ˜ ìˆìŒ</li></ul></li></ul></li></ul><p>Recommendation technique</p><ul><li>rating tableì„ recommendation ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥<ul><li>matrix frctorization</li></ul></li></ul><p>Average course ratings</p><ul><li>course_id, avg_rating</li><li>ë†’ì€ ë“±ê¸‰ì˜ ì½”ìŠ¤ë¥¼ ì¶”ì²œí•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— ì´ tableì´ ìœ ìš©í•  ê²ƒ</li></ul><p>Use the right programming language</p><ul><li>ì‚¬ìš©ìê°€ ê´€ì‹¬ì„ ê°–ëŠ” í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¡œ ëœ ê°•ì¢Œ ì¶”ì²œ</li><li>ê³¼ì •ë³„ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì— ëŒ€í•œ data, ì–´ë–¤ ê³¼ì •ì„ í‰ê°€í•˜ëŠ”ì§€ì— ëŒ€í•œ data</li><li>SQL ê³¼ì • 2ê°œë¥¼ í¬í•¨í•˜ì—¬ 4ê°œ ê³¼ì •ì„ í‰ê°€í•˜ë©´ ë‹¤ìŒ SQL ê³¼ì •ì„ ì¶”ì²œ</li></ul><p>Recommend new course</p><ul><li>ì‚¬ìš©ìê°€ í‰ê°€í•˜ì§€ ì•Šì€ ì½”ìŠ¤ ì¶”ì²œ</li><li>user_id, course_id combinationì´ rating tableì— ìˆìœ¼ë©´ ì•ˆë¨</li></ul><p>ì¶”ì²œ ì „ëµ</p><ul><li>ì‚¬ìš©ìê°€ ëŒ€ë¶€ë¶„ ì½”ìŠ¤ë¥¼ í‰ê°€í•œ ê¸°ìˆ ì˜ ì½”ìŠ¤ ì¶”ì²œ</li><li>í•´ë‹¹ ì‚¬ìš©ìì— ëŒ€í•´ ì´ë¯¸ í‰ê°€ëœ ì½”ìŠ¤ëŠ” ì¶”ì²œí•˜ì§€ ì•ŠìŒ</li><li>ê°€ì¥ ë†’ì€ ë“±ê¸‰ì„ ìœ ì§€í•˜ëŠ” ì„¸ ê°€ì§€ ì½”ìŠ¤ ì¶”ì²œ</li></ul><p>Filter out corrupt data</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">course_data </span><span class="token operator">=</span><span class="token plain"> extract_course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Print out the number of missing values per column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">isnull</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">sum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># The transformation should fill in the missing values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transform_fill_programming_language</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    imputed </span><span class="token operator">=</span><span class="token plain"> course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;programming_language&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;R&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> imputed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">transformed </span><span class="token operator">=</span><span class="token plain"> transform_fill_programming_language</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Print out the number of missing values per column of transformed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">transformed</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">isnull</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">sum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Using the recommender transformation</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Complete the transformation function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">transform_recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">avg_course_ratings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> courses_to_recommend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Merge both DataFrames</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    merged </span><span class="token operator">=</span><span class="token plain"> courses_to_recommend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">merge</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">avg_course_ratings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Sort values by rating and group by user_id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    grouped </span><span class="token operator">=</span><span class="token plain"> merged</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rating&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ascending</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Produce the top 3 values and sort by user_id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    recommendations </span><span class="token operator">=</span><span class="token plain"> grouped</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">head</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    final_recommendations </span><span class="token operator">=</span><span class="token plain"> recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;course_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;rating&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Return final recommendations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> final_recommendations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Use the function with the predefined DataFrame objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recommendations </span><span class="token operator">=</span><span class="token plain"> transform_recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">avg_course_ratings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> courses_to_recommend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ì§€ê¸ˆê¹Œì§€ í•œ ê²ƒë“¤</p><ul><li><code>extract_course_data()</code>, <code>extract_raing_data()</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ courses ë° rating í…Œì´ë¸”ì—ì„œ ë°ì´í„° Extract </li><li>courses í…Œì´ë¸”ì—ì„œ missing value clean up using transform_fill_programming_language()</li><li>ì½”ìŠ¤ ë‹¹ í‰ê·  ì½”ìŠ¤ ratingì„ ì–»ê¸°ìœ„í•´ ì§‘ê³„ í•¨ìˆ˜ ì œì‘: transform_avg_rating()</li><li>ì í•©í•œ ì‚¬ìš©ì, ì½”ìŠ¤ id ìŒì´ ìˆëŠ” DataFrame ì–»ê¸°: transform_courses_to_recommend()</li><li>recommendations ê³„ì‚°: transform_recommendations()</li></ul><p>Loading to Postgres</p><ul><li>recommendation engineì²˜ëŸ¼ data productì—ì„œ table ì‚¬ìš©í•  ìˆ˜ ìˆìŒ</li><li>Airflow ì‘ì—…ì˜ ëª¨ë“  ê²ƒì„ ì¡°ì •í•˜ì—¬ í…Œì´ë¸”ì„ ë§¤ì¼ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€</li><li>e.g. recommendationsì„ í†µí•´ íŠ¹ì • ê³ ê°ì—ê²Œ ì´ë©”ì¼ ë³´ë‚´ê¸°</li></ul><p>The loading phase</p><ul><li>í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ recommendations DataFrameì„ ê°€ì ¸ì˜¤ê¸°</li><li>pandasì˜ <code>.to_sql()</code> ì‚¬ìš©í•˜ì—¬ SQL í…Œì´ë¸”ì— ì“°ê¸°<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># í…Œì´ë¸” ì´ë¦„</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># db engine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if_exitsts</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;append&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># í…Œì´ë¸” ì¡´ì¬í•˜ëŠ” ê²½ìš°ì— ëŒ€í•œ ì „ëµ</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>etl()</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract the data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    courses </span><span class="token operator">=</span><span class="token plain"> extract_course_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    rating </span><span class="token operator">=</span><span class="token plain"> extract_rating_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Clean up courses data -&gt; NAë¥¼ ì±„ì›Œ courses table ì •ë¦¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    courses </span><span class="token operator">=</span><span class="token plain"> transform_fill_programming_language</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">courses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Get the average course ratings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    avg_course_rating </span><span class="token operator">=</span><span class="token plain"> transform_avg_rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Get eligible user and course id pairs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    courses_to_recommend </span><span class="token operator">=</span><span class="token plain"> transform_courses_to_recommend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        courses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate the recommendations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    recommendations </span><span class="token operator">=</span><span class="token plain"> transform_recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        avg_course_rating</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        courses_to_recommend</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Load the recommendations into the database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    load_to_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Creating the DAG</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> DAG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> airflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">operators</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">python_operator </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> PythonOperator</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;etl_pipeline&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 0 * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">task_recommendations </span><span class="token operator">=</span><span class="token plain"> PythonOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations_task&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    python_callable</span><span class="token operator">=</span><span class="token plain">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The target table</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">connection_uri </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://repl:password@localhost:5432/dwh&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">db_engine </span><span class="token operator">=</span><span class="token plain"> sqlalchemy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">create_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">connection_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">load_to_dwh</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    recommendations</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> if_exists</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replace&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Defining the DAG</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Define the DAG so it runs on a daily basis</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dag </span><span class="token operator">=</span><span class="token plain"> DAG</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dag_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          schedule_interval</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0 0 * * *&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Make sure `etl()` is called in the operator. Pass the correct kwargs.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">task_recommendations </span><span class="token operator">=</span><span class="token plain"> PythonOperator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    task_id</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;recommendations_task&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    python_callable</span><span class="token operator">=</span><span class="token plain">etl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    op_kwargs</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;db_engines&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> db_engines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Querying the recommendations</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">recommendations_for_user</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> threshold</span><span class="token operator">=</span><span class="token number">4.5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Join with the courses table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    query </span><span class="token operator">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    SELECT title, rating FROM recommendations</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    INNER JOIN courses ON courses.course_id = recommendations.course_id</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    WHERE user_id=%(user_id)s AND rating&gt;%(threshold)s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    ORDER BY rating DESC</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Add the threshold parameter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    predictions_df </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read_sql</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">query</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> db_engine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> params </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user_id&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> user_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                                             </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;threshold&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> threshold</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> predictions_df</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">values</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Try the function you created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">recommendations_for_user</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">4.65</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="í´ë¦½ë³´ë“œì— ì½”ë“œ ë³µì‚¬" title="ë³µì‚¬" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/teddygood/teddygood.github.io/tree/main/docs/Group-Study/data-engineering/data-engineer-with-python-week-02.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>í˜ì´ì§€ í¸ì§‘</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ë¬¸ì„œ íƒìƒ‰"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-01"><div class="pagination-nav__sublabel">ì´ì „</div><div class="pagination-nav__label">Data Engineering ìŠ¤í„°ë”” 1ì£¼ì°¨</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Group-Study/data-engineering/data-engineer-with-python-week-03"><div class="pagination-nav__sublabel">ë‹¤ìŒ</div><div class="pagination-nav__label">Data Engineering ìŠ¤í„°ë”” 3ì£¼ì°¨</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-data-engineering" class="table-of-contents__link toc-highlight">Introduction to Data Engineering</a></li><li><a href="#data-engineering-toolbox" class="table-of-contents__link toc-highlight">Data engineering toolbox</a></li><li><a href="#extract-transform-and-loadetl" class="table-of-contents__link toc-highlight">Extract, Transform and Load(ETL)</a></li><li><a href="#case-study-datacamp" class="table-of-contents__link toc-highlight">Case Study: DataCamp</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 teddygood Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d2d4c5dd.js"></script>
<script src="/assets/js/main.c6c575b9.js"></script>
</body>
</html>