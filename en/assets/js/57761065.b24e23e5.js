"use strict";(globalThis.webpackChunkmy_blog=globalThis.webpackChunkmy_blog||[]).push([[744],{957(e){e.exports=JSON.parse('{"permalink":"/en/blog/python-alpine-linux","editUrl":"https://github.com/teddygood/teddygood.github.io/tree/main/blog/2024-11-24-python-alpine-linux/2024-11-24-python-alpine-linux.md","source":"@site/i18n/en/docusaurus-plugin-content-blog/2024-11-24-python-alpine-linux/2024-11-24-python-alpine-linux.md","title":"Why Alpine Linux Should Be Avoided When Choosing a Docker Base Image for Python Projects","description":"Troubleshooting Issues When Deploying a Python Backend with Docker  \\n(Note: The original Korean text was a title/heading, so the translation reflects that structure. If you need elaboration on specific problems/solutions, additional context would be required.)  \\n\\n**Alternative (if intended as a sentence):**  \\n\\"I encountered and resolved issues while attempting to deploy a Python backend using Docker.\\"  \\n\\nLet me know if you\'d like a detailed troubleshooting guide or specific problem-solution pairs!","date":"2024-11-24T00:00:00.000Z","tags":[{"inline":true,"label":"Troubleshooting","permalink":"/en/blog/tags/troubleshooting"}],"hasTruncateMarker":true,"authors":[{"name":"Chanho Lee","title":"\ub2e4\uc591\ud55c \ubd84\uc57c\ub97c \uacf5\ubd80\ud558\uace0 \uc788\ub294 \ud559\uc0dd","url":"https://github.com/teddygood","imageURL":"https://github.com/teddygood.png","key":"teddygood","page":null}],"frontMatter":{"authors":"teddygood","date":"2024-11-24","description":"Troubleshooting Issues When Deploying a Python Backend with Docker  \\n(Note: The original Korean text was a title/heading, so the translation reflects that structure. If you need elaboration on specific problems/solutions, additional context would be required.)  \\n\\n**Alternative (if intended as a sentence):**  \\n\\"I encountered and resolved issues while attempting to deploy a Python backend using Docker.\\"  \\n\\nLet me know if you\'d like a detailed troubleshooting guide or specific problem-solution pairs!","draft":false,"keywords":["Docker","Python","Alpine Linux"],"slug":"/python-alpine-linux","tags":["Troubleshooting"],"title":"Why Alpine Linux Should Be Avoided When Choosing a Docker Base Image for Python Projects"},"unlisted":false,"prevItem":{"title":"\ud83d\udcd6Software Engineer Guidebook","permalink":"/en/blog/The-SE-guidebook"},"nextItem":{"title":"\u2728October Reflection","permalink":"/en/blog/Oct-Recap"}}')},8333(e,n,i){i.d(n,{A:()=>o});const o=i.p+"assets/images/cryptography-doc-7920a97dd96ca33edacacfbb8e6f2c1b.jpg"},16185(e,n,i){i.d(n,{A:()=>o});const o=i.p+"assets/images/crypto-building-error-d1fd632da6ad156fe5b2992ae3ad5b27.jpg"},28453(e,n,i){i.d(n,{R:()=>l,x:()=>r});var o=i(96540);const s={},t=o.createContext(s);function l(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),o.createElement(t.Provider,{value:n},e.children)}},44455(e,n,i){i.d(n,{A:()=>o});const o=i.p+"assets/images/alpine-linux-build-issue-18101324b11176113bb1b45925f4cb06.jpg"},80845(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var o=i(957),s=i(74848),t=i(28453);const l={authors:"teddygood",date:"2024-11-24",description:'Troubleshooting Issues When Deploying a Python Backend with Docker  \n(Note: The original Korean text was a title/heading, so the translation reflects that structure. If you need elaboration on specific problems/solutions, additional context would be required.)  \n\n**Alternative (if intended as a sentence):**  \n"I encountered and resolved issues while attempting to deploy a Python backend using Docker."  \n\nLet me know if you\'d like a detailed troubleshooting guide or specific problem-solution pairs!',draft:!1,keywords:["Docker","Python","Alpine Linux"],slug:"/python-alpine-linux",tags:["Troubleshooting"],title:"Why Alpine Linux Should Be Avoided When Choosing a Docker Base Image for Python Projects"},r=void 0,a={authorsImageUrls:[void 0]},d=[{value:"Introduction",id:"introduction",level:2},{value:"First Problem",id:"first-problem",level:2},{value:"Compatibility Issue Between Alpine Linux and cryptography",id:"compatibility-issue-between-alpine-linux-and-cryptography",level:3},{value:"Solution",id:"solution",level:3},{value:"Second Problem",id:"second-problem",level:2},{value:"Build Process Took Too Long and Failed",id:"build-process-took-too-long-and-failed",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Why Alpine Linux Is Not Ideal for Python Environments",id:"why-alpine-linux-is-not-ideal-for-python-environments",level:2},{value:"Drawbacks of Using Alpine Linux for Python:",id:"drawbacks-of-using-alpine-linux-for-python",level:3},{value:"\ud83c\udf10 References",id:"-references",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:["\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"I encountered several errors while moving a Django blog project to Docker. This post shares the knowledge I gained while resolving these issues."}),"\n",(0,s.jsx)(n.h2,{id:"first-problem",children:"First Problem"}),"\n",(0,s.jsx)(n.h3,{id:"compatibility-issue-between-alpine-linux-and-cryptography",children:"Compatibility Issue Between Alpine Linux and cryptography"}),"\n",(0,s.jsxs)(n.p,{children:["While building after creating the ",(0,s.jsx)(n.code,{children:"Dockerfile"})," and ",(0,s.jsx)(n.code,{children:"docker-compose.yml"}),", I encountered the following error:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ERROR: No matching distribution found for cryptography==3.4.7\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The Docker image version and cryptography version in ",(0,s.jsx)(n.code,{children:"requirements.txt"})," were as follows:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Dockerfile",children:"FROM python:3.8-alpine\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cryptography==3.4.7\n"})}),"\n",(0,s.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,s.jsxs)(n.p,{children:["I realized this was a compatibility issue between Alpine Linux and the cryptography package, which implements cryptographic algorithms in Python. After consulting the ",(0,s.jsx)(n.a,{href:"https://cryptography.io/en/latest/installation/",children:"official cryptography documentation"}),", I found a solution."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"crypto-doc",src:i(8333).A+"",width:"748",height:"503"})}),"\n",(0,s.jsxs)(n.p,{children:["In summary, cryptography uses Rust for building. This means ",(0,s.jsx)(n.strong,{children:"cargo"}),", Rust's package manager and build tool, must also be installed. I added the following to the Dockerfile:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ sudo apk add gcc musl-dev python3-dev libffi-dev openssl-dev cargo\n"})}),"\n",(0,s.jsx)(n.p,{children:"This resolved the first issue."}),"\n",(0,s.jsx)(n.h2,{id:"second-problem",children:"Second Problem"}),"\n",(0,s.jsx)(n.h3,{id:"build-process-took-too-long-and-failed",children:"Build Process Took Too Long and Failed"}),"\n",(0,s.jsx)(n.p,{children:'After adding the above commands to the Dockerfile and rebuilding, another error occurred. The build process kept running indefinitely (showing "still running") for about 10 minutes before eventually stopping.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"More detailed error",src:i(16185).A+"",width:"727",height:"109"})}),"\n",(0,s.jsx)(n.h3,{id:"solution-1",children:"Solution"}),"\n",(0,s.jsx)(n.p,{children:"After extensive research, I revisited the cryptography documentation and GitHub issues to find a similar case."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"More detailed error",src:i(44455).A+"",width:"1019",height:"833"})}),"\n",(0,s.jsx)(n.p,{children:"The key points from the issue were:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Building Python packages on Alpine Linux is slow, especially in CI/CD environments where rebuilding is frequent."}),"\n",(0,s.jsx)(n.li,{children:"Uploading Alpine-compatible wheels requires changes to pip/wheel/packaging, which involves ongoing PEP discussions."}),"\n",(0,s.jsx)(n.li,{children:"Installing Python packages properly on newer Alpine versions requires the latest Rust compiler."}),"\n",(0,s.jsx)(n.li,{children:"These issues are documented, and no improvements are currently planned. If further issues arise, new issues or PRs should be submitted."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The core takeaway was that ",(0,s.jsx)(n.strong,{children:"Alpine Linux itself was the problem"}),". Switching the base image resolved the issue:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Dockerfile",children:"FROM python:3.8-slim-buster\n"})}),"\n",(0,s.jsx)(n.p,{children:"But why did this happen? Let's explore the reasons."}),"\n",(0,s.jsx)(n.h2,{id:"why-alpine-linux-is-not-ideal-for-python-environments",children:"Why Alpine Linux Is Not Ideal for Python Environments"}),"\n",(0,s.jsx)(n.p,{children:"I initially chose Alpine Linux because it\u2019s smaller and faster to build compared to Ubuntu. However, it\u2019s not well-suited for Python environments."}),"\n",(0,s.jsxs)(n.p,{children:["The key difference lies in the C standard libraries used. Most Linux distributions use ",(0,s.jsx)(n.strong,{children:"GNU C Library (glibc)"})," for C programs, including Python. However, Alpine Linux uses ",(0,s.jsx)(n.strong,{children:"musl libc"})," for lightweight optimization. Since musl doesn\u2019t support ",(0,s.jsx)(n.code,{children:"Wheel binaries"})," compiled with glibc, it downloads ",(0,s.jsx)(n.code,{children:".tar.gz"})," files instead of ",(0,s.jsx)(n.code,{children:".whl"})," files. This means ",(0,s.jsx)(n.strong,{children:"all Python packages with C extensions must be compiled from source"}),", leading to longer build times and larger image sizes."]}),"\n",(0,s.jsxs)(n.p,{children:["Most modern Python packages include precompiled Wheel binaries on PyPI, which are essentially ZIP archives with a ",(0,s.jsx)(n.code,{children:".whl"})," extension. These speed up installations significantly. However, Alpine Linux bypasses this optimization."]}),"\n",(0,s.jsx)(n.h3,{id:"drawbacks-of-using-alpine-linux-for-python",children:"Drawbacks of Using Alpine Linux for Python:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Slow builds"})," due to source compilation."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Larger image sizes"})," from compiled dependencies."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Wasted time"})," waiting for builds."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Potential runtime bugs"})," from compatibility issues."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For Python projects, Debian-based ",(0,s.jsx)(n.strong,{children:"slim images"})," or ",(0,s.jsx)(n.strong,{children:"Ubuntu-based images"})," are more suitable than Alpine Linux."]}),"\n",(0,s.jsx)(n.h2,{id:"-references",children:"\ud83c\udf10 References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://cryptography.io/en/latest/installation/",children:"Cryptography installation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/pyca/cryptography/issues/5776",children:"Dependencies to build on Alpine Linux?"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://jonnung.dev/docker/2020/04/08/optimizing-docker-images/",children:"How to Build Docker Images Efficiently"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://pythonspeed.com/articles/alpine-docker-python/",children:"Using Alpine Can Make Python Docker Builds 50x Slower"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://pythonspeed.com/articles/base-image-python-docker-images/",children:"The Best Docker Base Image for Python Applications"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);